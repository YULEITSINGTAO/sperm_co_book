{
  "hash": "9a01abb8ee785213192e7261546d7ddd",
  "result": {
    "markdown": "# Crossover Frequency and Clinical Characteristics Association Study\n\n## CO and Age\n\n\n\n::: {.cell filename='R script'}\n\n```{.r .cell-code}\nIndividual_level_CO_freq <- readRDS(\"D:/sperm_project/sperm_CO_table/QUAL_RGQ_aneu_NA_removed_CO_and_clinical_assoc/Individual_level_CO_freq.rds\")\n\nIndividual_level_CO_freq$Age <- NA\n\nIndividual_level_CO_freq[grepl(\"AS\", Individual_level_CO_freq$Individual), \"Age\"] <- gsub(\"AS\", \"\", Individual_level_CO_freq[grepl(\"AS\", Individual_level_CO_freq$Individual), \"Individual\"])\nIndividual_level_CO_freq[grepl(\"NF\", Individual_level_CO_freq$Individual), \"Age\"] <- gsub(\"NF\", \"\", Individual_level_CO_freq[grepl(\"NF\", Individual_level_CO_freq$Individual), \"Individual\"])\nIndividual_level_CO_freq$Age <- gsub(\"-\\\\d\",\"\", Individual_level_CO_freq$Age) %>% as.integer()\n\nggplot(data = Individual_level_CO_freq, aes(x = Individual_level_CO_freq, y = Age, color = Type)) +\n  ggpmisc::stat_poly_eq(aes(label = paste(after_stat(eq.label),\n                               after_stat(rr.label), sep = \"*\\\", \\\"*\"))) +\n  stat_poly_line(se = FALSE) +\n  geom_point(size = 1) + \n  labs(\n       x = \"Individual Level CO Frequency\",\n       y = \"Age (in years)\") +\n  scale_color_manual(values=c(\"coral\", \"cornflowerblue\")) + theme_classic2() +\n  theme(legend.position = \"top\",\n        panel.border = element_rect(\n          color = \"black\",\n          size = 1,\n          fill = NA\n          ),\n        text = element_text(size = 12, color = \"black\"),\n        axis.text.x = element_text(size = 12, color = \"black\", face = \"bold\"),  # X-axis text color\n        axis.text.y = element_text(size = 12, color = \"black\", face = \"bold\"),\n        axis.title.x = element_text(size = 12, color = \"black\", face = \"bold\"),\n        axis.title.y = element_text(size = 12, color = \"black\", face = \"bold\")\n        ) + \n  xlim(c(0.5,1.75)) + ylim(c(20,60))\n\nggsave(paste0(\"D:/sperm_project/manuscript_09_23_2023/Figures/section_3_CO_distribution_and_frequency_count/CO_and_age.pdf\"), width = 3.5, height = 4)  \n```\n:::\n\n\n\n\n\n## CO and Other Characteristics\n\n\n\n::: {.cell filename='R script'}\n\n```{.r .cell-code}\n## Read the clinical info\n\nclinical_outcome <- readRDS(\"D:/sperm_project/phenotype/clinical_outcome.rds\")\n\n## Extract the AS and NF information \nAS_NF <- clinical_outcome$type\nnames(AS_NF) <- clinical_outcome$FID\nAS_NF <- as.data.frame(AS_NF)\n\n## Based on the clinical outcome matrix, we need to change the format of the files (rownames as clinical outcomes and colnums as patients)\n\nclinical_outcome <- clinical_outcome[, -c(2, ncol(clinical_outcome))]\n\n## Replace outliers and replace with mean\nreplace_outlier_with_mean <- function(x) {\n  replace(x, x %in% boxplot.stats(x)$out, mean(x))  \n}\n\nclinical_outcome[,-1] <- lapply(clinical_outcome[, -1], replace_outlier_with_mean)\n\n\nclinical_outcome$Individual <- str_extract(clinical_outcome$FID, str_c(c(\"AS\\\\d+\", \"NF\\\\d+-\\\\d\"), collapse = \"|\"))\nclinical_outcome[clinical_outcome$FID == \"AS32YRB\", \"Individual\"] = \"AS32-1\" \n\n## Now we can get clinical outcome with the same Individual ID with Sperm CO Individual IDs\n\n## Next, we are going to do a correltation study about the important clinical outcomes\n\nselected_clinical_outcomes <- c(\"ZHL\", \"QXYD\", \"VAPPJLJSL\", \"VCL\", \"VSL\", \"MAD\", \"LIN\", \"STR\", \"WOB\", \"BCF\")\n\nimportant_clinical_outcome <- clinical_outcome[, c(\"Individual\", selected_clinical_outcomes)]\n\nIndividual_level_CO_freq <- readRDS(\"D:/sperm_project/sperm_CO_table/QUAL_RGQ_aneu_NA_removed_CO_and_clinical_assoc/Individual_level_CO_freq.rds\")\n\nCO_and_clinical_outcome_table <- left_join(Individual_level_CO_freq, important_clinical_outcome, by = \"Individual\") %>% \n  mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))\n\ncolnames(CO_and_clinical_outcome_table)[2] <- \"CO\"\n\ncolnames(CO_and_clinical_outcome_table)[5:ncol(CO_and_clinical_outcome_table)] <- c(\"TV\", \"FM\", \"APS\", \"CS\", \"LV\", \"AAD\", \"LIN\", \"F\", \"WOB\", \"BCF\")\n\nCO_and_clinical_outcome_table$Age <- NA\n\nCO_and_clinical_outcome_table[grepl(\"AS\", CO_and_clinical_outcome_table$Individual), \"Age\"] <- gsub(\"AS\", \"\", CO_and_clinical_outcome_table[grepl(\"AS\", CO_and_clinical_outcome_table$Individual), \"Individual\"])\nCO_and_clinical_outcome_table[grepl(\"NF\", CO_and_clinical_outcome_table$Individual), \"Age\"] <- gsub(\"NF\", \"\", CO_and_clinical_outcome_table[grepl(\"NF\", CO_and_clinical_outcome_table$Individual), \"Individual\"])\nCO_and_clinical_outcome_table$Age <- gsub(\"-\\\\d\",\"\", CO_and_clinical_outcome_table$Age) %>% as.integer()\n\n# CO_and_clinical_outcome_table <- CO_and_clinical_outcome_table[!CO_and_clinical_outcome_table$Individual == \"NF27-3\", ]\n\nsaveRDS(CO_and_clinical_outcome_table, \"D:/sperm_project/sperm_CO_table/QUAL_RGQ_aneu_NA_removed_CO_and_clinical_assoc/CO_and_clinical_outcome_table.rds\")\n\n## Plot TV and FM\nCO_and_clinical_outcome_table <- readRDS(\"D:/sperm_project/sperm_CO_table/QUAL_RGQ_aneu_NA_removed_CO_and_clinical_assoc/CO_and_clinical_outcome_table.rds\")\n\n\np_TV <- ggplot(data = CO_and_clinical_outcome_table, aes(x = CO, y = TV, color = Type)) +\n  ggpmisc::stat_poly_eq(aes(label = paste(after_stat(eq.label),\n                               after_stat(rr.label), sep = \"*\\\", \\\"*\"))) +\n  stat_poly_line(se = FALSE) +\n  geom_point() + \n  labs(\n       x = \"Individual Level CO Frequency\",\n       y = \"Total Motility\") +\n  scale_color_manual(values=c(\"coral\", \"cornflowerblue\")) + theme_classic2() +\n  theme(legend.position=\"top\",\n        panel.border = element_rect(\n          color = \"black\",\n          size = 1,\n          fill = NA\n          ),\n        text = element_text(size = 12, color = \"black\"),\n        axis.text.x = element_text(size = 12, color = \"black\", face = \"bold\"),  # X-axis text color\n        axis.text.y = element_text(size = 12, color = \"black\", face = \"bold\"),\n        axis.title.x = element_text(size = 12, color = \"black\", face = \"bold\"),\n        axis.title.y = element_text(size = 12, color = \"black\", face = \"bold\")) + \n  xlim(c(0.5,1.75)) +\n  ylim(c(0,100))\n\nggsave(paste0(\"D:/sperm_project/manuscript_09_23_2023/Figures/section_3_CO_distribution_and_frequency_count/CO_and_TV.pdf\"), width = 3.5, height = 4)  \n\np_FM <- ggplot(data = CO_and_clinical_outcome_table, aes(x = CO, y = FM, color = Type)) +\n  ggpmisc::stat_poly_eq(aes(label = paste(after_stat(eq.label),\n                               after_stat(rr.label), sep = \"*\\\", \\\"*\"))) +\n  stat_poly_line(se = FALSE) +\n  geom_point() + \n  labs(\n       x = \"Individual Level CO Frequency\",\n       y = \"FM\") +\n  scale_color_manual(values=c(\"coral\", \"cornflowerblue\")) + theme_classic2() +\n  theme(legend.position=\"top\",\n        panel.border = element_rect(\n          color = \"black\",\n          size = 2,\n          fill = NA\n          ),\n        text = element_text(size = 12, color = \"black\"),\n        axis.text.x = element_text(color = \"black\"),  # X-axis text color\n        axis.text.y = element_text(color = \"black\"))\n\nggsave(paste0(\"D:/sperm_project/sperm_CO_table/CO_and_FM.pdf\"), width = 3.5, height = 4)  \n\n\nggpairs(CO_and_clinical_outcome_table[, c(\"CO\", \"TV\", \"FM\", \"APS\", \"CS\", \"LV\", \"AAD\", \"LIN\", \"F\", \"WOB\", \"BCF\", \"Age\", \"Type\")], aes(color = Type, alpha = 0.5),\n        lower = list(continuous = \"smooth\", size=0.05),\n        upper = list(continuous = wrap(\"cor\", size = 1.5)),) + \n  scale_color_manual(values=c(\"coral\", \"cornflowerblue\")) + \n  scale_fill_manual(values=c(\"coral\", \"cornflowerblue\")) + \n  theme(axis.text = element_text(size = 5),\n        strip.text.x = element_text(size = 5),\n        strip.text.y = element_text(size = 5))\nggsave(paste0(\"D:/sperm_project/sperm_CO_table/CO_and_clinical_outcome_ggpair_selected_correlated_motility_characteristics.pdf\"), width = 8, height = 8)  \n```\n:::\n\n\n\n## Multi-variable Regression \n\n\n\n::: {.cell filename='R script'}\n\n```{.r .cell-code}\nclinical_outcome_table <- CO_and_clinical_outcome_table %>% dplyr::select(TV, FM, APS, CS, LV, AAD, LIN, F, WOB, BCF, Age, Type)\n\ndata.pca <- princomp(clinical_outcome_table[, - 12])\npca_res <- prcomp(clinical_outcome_table[, - 12], scale. = TRUE)\n\nautoplot(pca_res, data = clinical_outcome_table, colour = 'Type', size = 3)\n\nPC_1_and_2 <- data.pca$loadings[, 1:2]\n\nfviz_pca_var(data.pca, col.var = \"black\")\n\nlm_CO_cli <- lm(CO  ~ ., data = CO_and_clinical_outcome_table %>% dplyr::select(TV, FM, APS, CS, LV, AAD, LIN, F, WOB, BCF, Age, CO))\nsummary(lm_CO_cli)\n```\n:::\n",
    "supporting": [
      "section_7_CO_and_clinical_outcome_association_study_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}