{
  "hash": "1fbbdc34ce98530d5a0987396c9f5a63",
  "result": {
    "markdown": "# Crossover Frequency and Genome Association Study\n\n## Prepare the dataset \n\n\n::: {.cell filename='R script'}\n\n```{.r .cell-code}\n## calculate the individual based sperm average CO of each chromosome\neach_sperm_chromosome_level_CO_freq <- readRDS(\"D:/sperm_project/sperm_CO_table/QUAL_RGQ_aneu_NA_removed_CO_and_clinical_assoc/each_sperm_each_chr_CO_table.rds\")\n\nindividual_average_chromosome_level_CO_freq <- each_sperm_chromosome_level_CO_freq %>% group_by(Individual, chr) %>% summarise(ave_CO = mean(chromosome_CO_count), .groups = 'drop')\n\n## Change the long format to wide format\nindividual_average_chromosome_level_CO_freq_wide <- spread(individual_average_chromosome_level_CO_freq, chr, ave_CO)\ncolnames(individual_average_chromosome_level_CO_freq_wide)[-1] <- paste0(\"chr\", colnames(individual_average_chromosome_level_CO_freq_wide)[-1])\n\nindividual_average_chromosome_level_CO_freq_wide$total <- rowSums(individual_average_chromosome_level_CO_freq_wide[, -1], na.rm=FALSE)\n\nindividual_average_chromosome_level_CO_freq_wide <- as.data.frame(individual_average_chromosome_level_CO_freq_wide)\n\n\n## Replace outliers and replace with mean\nreplace_outlier_with_mean <- function(x) {\n  replace(x, x %in% boxplot.stats(x)$out, mean(x))  \n}\n\noutliner_removed_individual_average_chromosome_level_CO_freq_wide <- individual_average_chromosome_level_CO_freq_wide\n\noutliner_removed_individual_average_chromosome_level_CO_freq_wide[, -1] <- lapply(outliner_removed_individual_average_chromosome_level_CO_freq_wide[, -1], replace_outlier_with_mean)\n\nscaled_outliner_removed_individual_average_chromosome_level_CO_freq_wide <- outliner_removed_individual_average_chromosome_level_CO_freq_wide\n\nscaled_outliner_removed_individual_average_chromosome_level_CO_freq_wide[-1] <- scale(scaled_outliner_removed_individual_average_chromosome_level_CO_freq_wide[-1])\n\n## Read the .fam file in to R\nfam_file <- read.table(\"D:/sperm_project/GEMMA/Blood_and_CO/new_input_files_19_09_2023/blood.fam\")\n\n## Extract the blood individual information\nblood_name_fam_file <- fam_file[, c(1:5)]\n\nblood_name_fam_file$V6 <- str_extract(blood_name_fam_file$V1, str_c(c(\"AS\\\\d+\", \"NF\\\\d+-\\\\d\"), collapse = \"|\"))\n\nblood_name_fam_file[blood_name_fam_file$V1 == \"AS32YRBB\", \"V6\"] = \"AS32-1\" \n\nblood_name_fam_file <- left_join(blood_name_fam_file, individual_average_chromosome_level_CO_freq_wide, by = c(\"V6\" = \"Individual\"))\n\n\ninclude_sample_list <- na.omit(blood_name_fam_file)[\"V1\"]\ninclude_sample_list$V2 <- include_sample_list$V1\n\n# Write the data frame to a tab-delimited file\nwrite.table(include_sample_list, file = \"D:/sperm_project/GEMMA/Blood_and_CO/include_sample.txt\", sep = \"\\t\", row.names = FALSE, col.names = FALSE, quote = FALSE)\n\n\nimpute_new_fam_file <- as.data.frame(blood_name_fam_file) %>% mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))\n\nimpute_new_fam_file <- impute_new_fam_file[, -6]\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}